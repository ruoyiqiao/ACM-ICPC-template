\subsection{Trie}
\begin{lstlisting}[language=c++]
struct Trie{
    int ch[N][26], tot;
    int dfn[N], cid[N], out[N], cnt;
    int ins(string s){
        int p = 1, len = s.size();
        for(int i=0;i<len;i++){
            int c = s[i] - 'a';
            if(!ch[p][c]) ch[p][c] = ++tot;
            p = ch[p][c];
        }
        return p;
    }
    void dfs(int x){
        dfn[x] = ++cnt, cid[cnt] = x;
        for(int i=0;i<26;i++){
            if(ch[x][i]) dfs(ch[x][i]);
        }
        out[x] = cnt;
    }
    int find(string s, int k){
        int p = 1;
        for(int i=0;i<k;i++){
            int c = s[i] - 'a';
            if(!ch[p][c]) return -1;
            p = ch[p][c];
        }
        return p;
    }
}trie;
\end{lstlisting}